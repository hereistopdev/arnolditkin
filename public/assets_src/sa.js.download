(function(c){typeof define=="function"&&define.amd?define(c):c()})(function(){"use strict";var vt=Object.defineProperty;var Z=c=>{throw TypeError(c)};var _t=(c,a,l)=>a in c?vt(c,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[a]=l;var O=(c,a,l)=>_t(c,typeof a!="symbol"?a+"":a,l),H=(c,a,l)=>a.has(c)||Z("Cannot "+l);var p=(c,a,l)=>(H(c,a,"read from private field"),l?l.call(c):a.get(c)),S=(c,a,l)=>a.has(c)?Z("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(c):a.set(c,l),y=(c,a,l,D)=>(H(c,a,"write to private field"),D?D.call(c,l):a.set(c,l),l),g=(c,a,l)=>(H(c,a,"access private method"),l);var m,E,_,b,h,R,J,Q,x,tt;const c=document.body.getAttribute("data-api")||"api";let a;if(c==="local"){const n=/analytics-(\w+)\.scorpion\.co/.exec(window.location.hostname);n!=null&&n[1]?a=`https://${n[1]}.scorpion.co/platform/analytics`:a="https://sa.scorpion.co"}else c==="api"?a="https://sa.scorpion.co":c.endsWith("-csx")?a=`https://${c.replace("-csx","")}.scorpion.co/platform/analytics`:a=`https://${c}.scorpion.co/platform/analytics`;function l(n){return n.width!==void 0}function D(n){return n.video!==void 0}function et(n){return n.to!==void 0}async function nt(n){const t=await w("/event/visit",n);return t==null?void 0:t.result}async function L(n){const t=await w("/event/click",n);return t==null?void 0:t.result}async function st(n){const t=await w("/event/restart",n);return t==null?void 0:t.result}async function it(n){const t=await w("/event/update-phone",n);return t==null?void 0:t.result}async function U(n){const t=await w("/event/play",n),e=t==null?void 0:t.result;return ot(n,e),e}function ot(n,t){if(t!=null&&t.videoPlayId&&n.videoId){const e=document.getElementById(n.videoId);if(e instanceof HTMLVideoElement){const s=e.sa;s&&(s.vvid=t.videoPlayId,s.vpid=t.videoPlayingId)}}}async function W(n){const t=await w("/event/playing",n);return t==null?void 0:t.result}async function ct(n){const t=await w("/event/init",n);return t==null?void 0:t.result}async function w(n,t){const e=`${a}${n}`;return await(await fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t),keepalive:!0})).json()}function at(n){return n?encodeURIComponent(String(n)).replace(/['"()]/g,function(t){switch(t){case"'":return"%27";case'"':return"%22";case"(":return"%28";case")":return"%29";default:return t}}):""}function rt(n){return n?decodeURIComponent(String(n).replace(/\+/g,"%20")):""}function dt(n){const t=n.target,e=t==null?void 0:t.closest("a"),s=(e==null?void 0:e.getAttribute("href"))||void 0,i=t==null?void 0:t.closest("button"),o=i==null?void 0:i.closest("form"),r=o==null?void 0:o.getAttribute("action"),u=(o==null?void 0:o.getAttribute("method"))==="post"||!1,f=e||i||t,P=r&&(o==null?void 0:o.getAttribute("data-search"))&&lt(o);return{selector:ht(f).join(" "),href:s,post:u,search:P||void 0}}function lt(n){const t=n==null?void 0:n.getElementsByTagName("input");if(t){for(const e of t)if((e==null?void 0:e.getAttribute("type"))==="text"&&ut(e))return e.value}}function ut(n){return!!(n&&(n.offsetWidth||n.offsetHeight||n.getClientRects().length))}function ht(n){const t=ft(n),e=[];for(const s of t){let i;if(s.id)return e.unshift(`#${s.id}`),e;if(s.cls)i=`${s.name}.${s.cls}`;else if(s.name)i=s.name;else continue;const o=s.el.querySelectorAll(i);if(o.length>1){const r=Array.prototype.indexOf.call(o,s.el);r!==-1&&(i+=`:nth-child(${r+1})`)}e.unshift(i)}return e}function ft(n){const t=[];let e=n;for(;e&&e.parentNode&&e!==document.body&&e!==document.documentElement;){const s=e.getAttribute("id");if(s)return t.push({el:e,id:s}),t;const i=gt(e),o=(e.nodeName||"").toLowerCase();(i||o==="li"||!t.length)&&t.push({el:e,name:o,cls:i}),e=e.parentNode}return t}function gt(n){const t=(n.getAttribute("class")||"").trim();return t?t.replace(/(\s+)|([^\w-])/g,function(e,s,i){return s?".":i?`\\${i}`:""}):""}function mt(){const n=new Date,t=new Date(n.getFullYear(),0,1),e=new Date(n.getFullYear(),6,1);return Math.max(t.getTimezoneOffset(),e.getTimezoneOffset())/60}function j(){const n=document.getElementsByTagName("a");for(const t of n){const e=t.getAttribute("href"),s=e&&/^tel:(.+)$/.exec(e);if(s){const i=s[1].replace(/\D+/g,"");if(i&&i.length>=10)return i}}}function pt(){const n=document.getElementsByClassName("ui-track-version"),t=new Set;for(let e=0;e<n.length;e++){const s=n[e].getAttribute("id");s&&t.add(s)}return t.size?[...t]:void 0}function Y(){var t,e;let n;try{n=(e=(t=window.Process)==null?void 0:t.Phones)==null?void 0:e.call(t)}catch{}return n==null?void 0:n.split("|")}const wt=new Set(["_cldee","_gl","_hsenc","adct","adid","adposition","adsubid","bidmatchtype","cam","campaignid","cmp","creative","date_created","device","devicemodel","dicbo","dynamic_proxy","epik","esid","external_browser_redirect","fbclid","fccdbefkve","fccdbeve","furl","g","gad","gclid","hsa_acc","hsa_ad","hsa_cam","hsa_grp","hsa_kw","hsa_mt","hsa_net","hsa_src","hsa_tgt","hsa_ver","interestloc","keyword","keywordid","kw","li_fat_id","loc_interest_ms","loc_physical_ms","matchtype","mc_cid","mc_eid","ms","msclkid","nb","network","networktype","nx","oborigurl","physicalloc","pp","primary_serv","psafe_param","pub_cr_id","querystr","random","refpageviewid","rl_key","rl_site","rl_siteid","rl_sitelink","se_action","sppc","sppcadexid","sppcadid","sppccampaignid","sppckeywordid","ssp_iabi","targetid","tblci","tc","testmode","twclid","useyb","usps_mid","usps_sn","utm_brand","utm_campaign","utm_content","utm_medium","utm_scrub","utm_source","utm_term","vs_key","wbraid"]);function N(n){let t;if(window.location.search){const e=new URL(window.location.href),s=new URLSearchParams,i=[...e.searchParams];for(const[r,u]of i){const f=r==null?void 0:r.toLowerCase();(!f||!wt.has(f))&&s.set(r,u)}const o=s.toString();o?t=`${window.location.pathname}?${o}#~${n}`:t=`${window.location.pathname}#~${n}`}else t=`#~${n}`;window.history.replaceState(void 0,"",t)}function $(){const n=window.location.hash;if((n==null?void 0:n.length)===38&&n[1]==="~")return n.substring(2)}const d={get:n=>{const t=document.cookie.match(`(^|;)\\s*${n}\\s*=\\s*([^;]+)`),e=t==null?void 0:t.pop();if(!e)return null;switch(e[0]){case"#":return+e.substring(1);case"!":return e==="!!";case":":return new Date(+e.substring(1));default:return rt(e)}},set:(n,t,e=!1)=>{if(t===null||typeof t>"u"){d.delete(n);return}let s;typeof t=="number"?s=`#${t}`:typeof t=="boolean"?s=t?"!!":"!":t?t instanceof Date?s=`:${t.getTime()}`:typeof t=="string"?s=at(t):s=String(t):s="";let i;e?e instanceof Date||(i=new Date,typeof e=="number"?i.setDate(i.getDate()+e):i.setDate(i.getDate()+30)):i=null;const o=i?`; expires = ${i.toUTCString()}`:"";document.cookie=`${n}=${s}; path=/${o}`},delete:n=>{const t=new Date(0).toUTCString();document.cookie=`${n}=; path=/; expires=${t}`}},M=document.documentElement.getAttribute("data-sa"),v=M?decodeURIComponent(M):"",A=!document.documentElement.getAttribute("data-sd")&&!window.location.hostname.endsWith("scorpion.co"),V="_sa",q="sa_",z="vid_",X="sa_info",It=24*60*60*1e3,k=class k{constructor(){S(this,h);S(this,m);O(this,"ready");S(this,E);S(this,_,!1);S(this,b,[]);this.ready=new Promise(e=>y(this,m,e)),g(this,h,J).call(this)||g(this,h,x).call(this,!0),this._click=this._click.bind(this),this._play=this._play.bind(this),this._playing=this._playing.bind(this),window._sa_videoStart=this._play,window._sa_videoPlay=this._playing,window._sa_getHitId=()=>this.hidId,document.addEventListener("click",this._click,!0)}get visitorId(){return localStorage.getItem(z)||void 0}set visitorId(t){localStorage.setItem(z,t)}get sessionId(){const t=Number(localStorage.getItem(X));if(!t)return;const e=new Date().getTime()-It;if(t<e)return;const s=d.get(q);return s?String(s):void 0}set sessionId(t){d.set(q,t),localStorage.setItem(X,String(new Date().getTime()))}get legacyId(){return+(d.get(V)||0)}set legacyId(t){d.set(V,t);try{const e=new CustomEvent("analytics.sessionId",{bubbles:!0,cancelable:!0,detail:{sessionId:t}});document.documentElement.dispatchEvent(e)}catch{}}get hidId(){return p(this,E)}set hitId(t){y(this,E,t)}_click(t){const e=dt(t),s=window.innerWidth||document.documentElement.offsetWidth||document.body.offsetWidth||0,i=window.innerHeight||document.documentElement.offsetHeight||document.body.offsetHeight||0,o=Math.max(document.documentElement.scrollTop,document.body.scrollTop),r={sessionId:this.sessionId||"",hitId:this.hidId||"",sa:v,page:window.location.href,selector:e.selector,width:s,height:i,scrollTop:o,x:t.pageX||t.clientX||0,y:t.pageY||t.clientY||0,href:e.href,post:e.post,search:e.search,location:Number(d.get("L"))||0};if(r.sessionId){L(r);return}else g(this,h,R).call(this,r)}_play(t,e,s,i,o,r){const u={videoPlayId:e||void 0,sessionId:this.sessionId||"",hitId:this.hidId||"",sa:v,page:window.location.href,videoId:t,video:s,from:i,duration:o,autoStart:!!r,location:Number(d.get("L"))||0};u.sessionId?U(u):g(this,h,R).call(this,u)}_playing(t,e,s,i){const o={videoPlayId:t,videoPlayingId:e,sa:v,page:window.location.href,to:s,duration:i,location:Number(d.get("L"))||0};W(o)}};m=new WeakMap,E=new WeakMap,_=new WeakMap,b=new WeakMap,h=new WeakSet,R=function(t){p(this,b).push(t),p(this,_)||g(this,h,x).call(this)},J=function(){if(!A||d.get("SPPC"))return!1;const t=this.sessionId,e=$();return e&&e!==t?(g(this,h,Q).call(this,e),!0):!1},Q=async function(t){var o,r;const e={...F(this.visitorId,this.sessionId),restartId:t},s=await st(e);if(!(s!=null&&s.sessionId)){await g(this,h,x).call(this);return}if(this.visitorId=s.visitorId,this.sessionId=s.sessionId,this.hitId=s.hitId,s.paid){d.set("SPPC",s.paid,30),d.set("PPCAD",s.adId||null,30),d.set("PPCEX",s.adExtension||null,30),d.set("PPCCMP",s.campaignId||null,30);try{await fetch(window.location.href)}catch{}try{(r=(o=window.Process)==null?void 0:o.Delayed)==null||r.call(o)}catch{}const u=j();if(u&&u!==e.phoneNumber){const f={sessionId:s.sessionId,hitId:s.hitId,sa:v,page:window.location.href,phoneNumber:u,pooling:Y()};await it(f)}}d.get("SPPC")&&s.sessionId&&s.sessionId!==$()&&N(s.sessionId)},x=async function(t=!1){var r,u,f,P;const e=this.visitorId,s=this.sessionId,i=F(e,s);t&&A&&i.paid&&s&&N(s),y(this,_,!0);const o=await nt(i);if(y(this,_,!1),!(o!=null&&o.sessionId)){(r=p(this,m))==null||r.call(this),y(this,m,void 0);return}if(o.sessionId!==s&&(this.legacyId=0),this.visitorId=o.visitorId,this.sessionId=o.sessionId,this.hitId=o.hitId,t&&A&&i.paid&&o.sessionId&&o.sessionId!==$()&&N(o.sessionId),t)try{(f=(u=window.Process)==null?void 0:u.Delayed)==null||f.call(u)}catch{}if(!this.legacyId){const C={id:this.sessionId,sa:v,page:window.location.href},I=await ct(C);if(!(I!=null&&I.legacyId)||I.sessionId!==o.sessionId)return;this.legacyId=I.legacyId}await g(this,h,tt).call(this),(P=p(this,m))==null||P.call(this),y(this,m,void 0)},tt=async function(){const t=this.sessionId,e=this.hidId;if(!t||!e)return;const s=[...p(this,b)];if(s.length){p(this,b).length=0;for(const i of s)l(i)?(i.sessionId=t,i.hitId=e,await L(i)):D(i)?(i.sessionId=t,i.hitId=e,await U(i)):et(i)&&await W(i)}},O(k,"current",new k);let B=k;function F(n,t){const e=new URL(window.location.href),s=new Map,i=[...e.searchParams];for(const[T,K]of i){const G=T==null?void 0:T.toUpperCase();G&&K&&s.set(G,K)}const o=d.get("SPPC")||s.get("SPPC")||void 0,r=d.get("SEOR")||document.referrer,u=d.get("SEOK")||s.get("KEYWORD")||s.get("KEYWORDS")||void 0,f=window.innerWidth||document.documentElement.offsetWidth||document.body.offsetWidth||0,P=window.innerHeight||document.documentElement.offsetHeight||document.body.offsetHeight||0,C=Number(d.get("PPCAD"))||Number(s.get("SPPCADID"))||void 0,I=Number(d.get("PPCEX"))||Number(s.get("SPPCADEXID"))||void 0,yt=Number(d.get("PPCCMP"))||Number(s.get("SPPCCAMPAIGNID"))||void 0;return{visitorId:n,sessionId:t,sa:v,page:window.location.href,paid:o,referrer:r,keywords:u,width:f,height:P,timeZone:mt(),phoneNumber:j(),adId:C,adExtension:I,campaignId:yt,location:Number(d.get("L"))||void 0,engagement:pt(),pooling:Y()}}});
//# sourceMappingURL=sa.js.map
